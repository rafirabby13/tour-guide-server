enum UserRole {
  TOURIST
  GUIDE
  ADMIN
}

enum UserStatus {
  ACTIVE
  INACTIVE
  DELETED
}

enum Gender {
  MALE
  FEMALE
}

model User {
  id                 String     @id @default(uuid())
  email              String     @unique
  password           String
  role               UserRole   @default(TOURIST)
  needPasswordChange Boolean    @default(true)
  status             UserStatus @default(ACTIVE)
  isDeleted     Boolean  @default(false)
  createdAt          DateTime   @default(now())
  updatedAt          DateTime   @updatedAt
  admin              Admin?
  guide              Guide?
  tourist            Tourist?

  @@map("users")
}

model Admin {
  id            String   @id @default(uuid())
  name          String?
  userId        String   @unique
  profilePhoto  String?
  contactNumber String?
  isDeleted     Boolean  @default(false)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  user User @relation(fields: [userId], references: [id])

  @@map("admins")
}

enum ExperienceLevel {
  BEGINNER // 0-2 years
  INTERMEDIATE // 2-5 years
  EXPERT // 5+ years
}

model Guide {
  id              String          @id @default(uuid())
  name            String?
  userId          String          @unique
  profilePhoto    String?
  contactNumber   String?
  bio             String?         @db.Text
  experience      Int             @default(0)
  experienceLevel ExperienceLevel @default(BEGINNER)
  languages       String[]
  category        String[]
  country         String?
  city            String?
  gender          Gender?
  isAvailable     Boolean         @default(true)
  rating          Float           @default(0.0)
  totalReviews    Int             @default(0)
  totalTours      Int             @default(0)
  isDeleted       Boolean         @default(false)
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt

  user User   @relation(fields: [userId], references: [id])
  tour Tour[] @relation("GuideTours")

  @@index([city, country])
  @@index([isAvailable])
  @@map("guides")
  blockedDates BlockedDate[]
  booking Booking[]
  reviews Review[]
}

model Tourist {
  id            String   @id @default(uuid())
  name          String
  userId        String   @unique
  profilePhoto  String?
  contactNumber String
  category      String[]
  languages     String[]
  gender        Gender
  isDeleted     Boolean  @default(false)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  user User @relation(fields: [userId], references: [id])

  bookings Booking[]
  reviews  Review[]

  @@map("tourists")
}
